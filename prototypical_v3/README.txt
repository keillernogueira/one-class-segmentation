This version tries to use multiple prototypes.
Assigns the pixels to the closest prototype.